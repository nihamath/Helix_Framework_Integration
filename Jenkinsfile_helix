pipeline {

    agent any


    parameters {
        choice(name: 'TEST_SUITE', choices:['integration_test.xml'], description: 'Test Suite to be executed')
        string(name: 'TargetURL', defaultValue: 'https://google.com', description: 'Target base url for test execution')
         string(name: 'automationSuite', defaultValue: 'Helix Automation Demo suite', description: 'Automation suite name')
    }

    stages {
        stage('run integration test') {
            steps {

                sh "mvn test -Dtestng.suitexml=${params.TEST_SUITE} -Dtest.url.base=${params.TargetURL}"
            }
        }

    }

    post{
       always {


         halm_report automationSuite: "${params.automationSuite}",
         automationSuiteID: 5,
         halmConnectionID: '915bc48c-f8a2-491c-b471-2b25cf4781c1',
         projectID: '{a062321e-26cb-4e60-b955-5409606b35c2}',
         testFileFormat: '0',
         testFilePattern: 'target\\surefire-reports\\junitreports\\TEST-TestCase.xml'
       }
    }

}